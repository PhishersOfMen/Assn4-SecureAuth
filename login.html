<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Login</title>
  </head>

  <body>
    <h1>Login</h1>
    <div>
      <div>
        <span>Email:</span>
        <input type="text" name="email" />
      </div>
      <div>
        <span>Password:</span>
        <input type="password" name="pass" />
      </div>
      <div>
        <button id="loginButton" type="button" onclick="login()">Login</button>
      </div>
    </div>
    <div>
      <span id="errorLog"></span>
      <!-- <span>Errors: </span> -->
    </div>

    <script>
      var isLockedOut = false;
      var lockoutTime = 0;
      var loginAttempts = 0;
      var validPassword = false;
      function lock() {
        isLockedOut = true;
        setTimeout(unlock, 2 ** lockoutTime * 1000);
        lockoutTime++;
        document.getElementById("loginButton").disabled = true;
        error(
          `You have been locked out for ${2 ** lockoutTime * 1000} seconds`
        );
      }
      function unlock() {
        isLockedOut = false;
        loginAttempts = 0;
        document.getElementById("loginButton").disabled = false;
      }
      function error(message) {
        document.getElementById("errorLog").innerHTML = message;
      }
      function login() {
        console.log(
          "Locked out",
          isLockedOut,
          "Time",
          lockoutTime,
          "Attempts",
          loginAttempts
        );
        if (isLockedOut) {
          error(
            `You have been locked out for ${2 ** lockoutTime * 1000} seconds`
          );
        } else {
          //CALL FUNCTION
          if (validPassword) {
            //Check password
            lockoutTime = 0;
            loginAttempts = 0;
          } else {
            loginAttempts++;
            if (loginAttempts >= 3) lock();
            else
              error(
                `Email or Password is incorrect. Attempts remaining: ${3 -
                  loginAttempts}`
              );
          }
        }
      }
    </script>
  </body>
</html>
