<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="styles.css">
    <title>Create Password</title>
    <script>
        function verify(){
            let pass = document.getElementById("pass").value;
            let confpass = document.getElementById("confpass").value;
            let error = document.getElementById("error");

            if (pass != confpass) {
                error.classList.remove("hide");
                error.textContent = "Passwords do not match.";
            }
            else {
                error.classList.add("hide");
                getData(pass);
                // error.textContent = err;
                error.classList.remove("hide");
            }
        }

        function getData(password) {
            let URL = `./cgi-bin/verify_password.py?username=${window.localStorage.getItem("User")}&password=${password}`;
            let params = {
                "method": "GET",
            };

            fetch(URL, params)
               .then((response) => {
                    return response.json();
               })
               .then((data) => {
                   if (data.error) {
                       document.getElementById("error").textContent = data.error;
                    // return data.error;
                   }
                   else {
                       window.location.replace("./index.html");
                   }
               }) 
        }
    </script>
</head>

<body>
    <h1 class="title">Create Password</h1>
    <div id="passwords" class="container">
        <p id="error" class="hide error"></p>

        <div class="label-group">
            <label for="pass">Password</label>
            <input type="password" name="pass" id="pass">
        
        </div>
        <div class="label-group">
            <label for="confpass">Confirm Password</label>
            <input type="password" name="confpass" id="confpass">
        </div>

        <input class="btn" type="submit" value="SUBMIT" onclick="verify()">
    </div>
</body>

</html>