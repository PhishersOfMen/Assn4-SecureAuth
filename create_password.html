<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="styles.css">
    <title>Create Password</title>
    <script>
        function verify(){
            let pass = document.getElementById("pass").value;
            let confpass = document.getElementById("confpass").value;
            let error = document.getElementById("error");

            if (pass != confpass) {
                error.classList.remove("hide");
                error.textContent = "Passwords do not match.";
            }
            else {
                error.classList.add("hide");
                getData(pass);
                // error.textContent = err;
                error.classList.remove("hide");
            }
        }

        function getData(password) {
            let URL = `./cgi-bin/verify_password.py?username=${window.localStorage.getItem("User")}&password=${password}`;
            let params = {
                "method": "GET",
            };

            fetch(URL, params)
               .then((response) => {
                    return response.json();
               })
               .then((data) => {
                   if (data.error) {
                       document.getElementById("error").textContent = data.error;
                    // return data.error;
                   }
                   else {
                       window.location.replace("./index.html");
                   }
               }) 
        }
    </script>
</head>

<body>
    <h1>Create Password</h1>
    <div id="passwords">
        <label for="pass">Password</label>
        <input type="password" name="pass" id="pass"> <br>

        <label for="confpass">Confirm Password</label>
        <input type="password" name="confpass" id="confpass"> <br>

        <input type="submit" value="SUBMIT" onclick="verify()">
        
        <p id="error" class="hide"></p>
    </div>
</body>

</html>